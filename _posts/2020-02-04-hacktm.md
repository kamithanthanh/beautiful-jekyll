---
layout : post
title : Hacktm CTF 2020    
---   


# HackTm 2019    
  - 4 solved :     
     ğŸ‘‰ RSA1    
     ğŸ‘‰ RSA2    
     ğŸ‘‰ Prision break    
     ğŸ‘‰ [**Baby bear**](#wu1)     
  - unsolved : many :))) but read writeup so listed here   
     ğŸ‘‰ 

<a name="wu1"></a>     

# Baby bear     
ÄÃ¢y lÃ  má»™t file bá»‹ pack bá»Ÿi UPX nhÆ°ng Ä‘Ã£ bá»‹ sá»­a :vv   ğŸ˜…ğŸ˜…ğŸ˜… NhÆ°ng magic lÃ  váº«n Ä‘á»c Ä‘Æ°á»£c Ä‘áº§y Ä‘á»§ code vÃ¬ nÃ³ Ä‘Æ°á»£c compile tá»« assembly. Váº«n cÃ³ nhá»¯ng string cÃ¹ng vá»›i má»™t sá»‘ hÃ m cÆ¡ báº£n nÃªn viá»‡c reverse mÃ  khÃ´ng cáº§n unpack lÃ  Ä‘iá»ƒu kháº£ thi.    
![](/ctf/2020/hacktm/baby_bear/hinh1.PNG)    

HÃ m ```start``` :    

![](/ctf/2020/hacktm/baby_bear/hinh2.PNG)    

HÃ m start báº¯t Ä‘áº§u báº±ng viá»‡c Ä‘á»c 16 bytes tá»« file /dev/urandom lÃ m giÃ¡ trá»‹ khá»Ÿi táº¡o, chuyá»ƒn nÃ³ vá» dáº¡ng bit theo kiá»ƒu 'a' -> '10000110' rá»“i in hÃ¬nh con gáº¥u.   Sau Ä‘Ã³, lÃ  Ä‘áº¿n Ä‘oáº¡n mÃ£ hÃ³a string :    

![](/ctf/2020/hacktm/baby_bear/hinh3.PNG)    

Do Ä‘ang bá»‹ pack nÃªn trÃ´ng khÃ´ng ra hÃ m nhÆ°ng ta cÃ³ thá»ƒ hiá»ƒu Ä‘Æ°á»£c hÃ m mÃ£ hÃ³a nÃ y cÃ³ hai tham sá»‘ truyá»n vÃ o lÃ  Ä‘á»™ dÃ i Ä‘oáº¡n mÃ£ hÃ³a Ä‘áº§u ra lÃ  46 vÃ  Ä‘á»‹a chá»‰ lÆ°u giá»¯ string lÃ  ```esi = 0x600780```.   
Trong má»—i láº§n láº·p, nÃ³ sáº½ tÄƒng esi lÃªn tá»« 1 - 3 Ä‘Æ¡n vá»‹ vÃ  cho ra má»™t giÃ¡ trá»‹ output, in ra mÃ n hÃ¬nh báº±ng hÃ m ```sub_4000B0```. Output Ä‘áº§u ra cÃ³ thá»ƒ láº¥y tá»« chuá»—i truyá»n vÃ o hoáº·c khÃ´ng, do Ä‘Ã³ input mÃ  ta tÃ¬m Ä‘Æ°á»£c cÃ³ thá»ƒ khÃ´ng giá»‘ng vá»›i input ban Ä‘áº§u.    
Ban Ä‘áº§u , mÃ¬nh dÃ¹ng unicorn Ä‘á»ƒ dá»±ng láº¡i hÃ m mÃ£ hÃ³a nÃ y, cho má»™t input Ä‘áº§u vÃ o vÃ  cÃ³ Ä‘Æ°á»£c output Ä‘áº§u ra. Viá»‡c thiáº¿t láº­p unicorn theo cÃ¡c bÆ°á»›c khÃ´ng quÃ¡ phá»©c táº¡p : [basic setup](https://www.notion.so/Basic-Setup-179a2615e2a7472d8083423f05126bf8) vÃ  [execute binary function](https://www.notion.so/Execute-Binary-Function-08884ed07d9b44519c44963fb641b35e) . ğŸ˜ğŸ˜ğŸ˜Sau khi chÆ¡i vá»›i input ngáº«u nhiÃªn vÃ  xem output Ä‘áº§u ra lÃ  gÃ¬, mÃ¬nh rÃºt ra Ä‘Æ°á»£c nháº­n xÃ©t lÃ  cá»© 2 bytes Ä‘áº§u thÃ¬ output Ä‘áº§u ra giá»‘ng nhau Ã­t nháº¥t lÃ  8 bits, 3 bytes thÃ¬ lÃ  11 bits, .... (ï½oï¿£3ï¿£)ï½ BÃ™m mÃ¬nh Ä‘á»‹nh brute force tá»« Ä‘Ã¢y. NhÆ°ng cÃ³ quÃ¡ nhiá»u trÆ°á»ng há»£p vÃ  thá»i gian bruteforce cÃ³ thá»ƒ lÃªn tá»›i Ä‘Æ¡n vá»‹ tiáº¿ng mÃ  timeout cá»§a server chá»‰ lÃ  30s ğŸ™„ğŸ™„ğŸ™„ Vá»›i trÃ¬nh Ä‘á»™ má»›i táº­p chÆ¡i unicorn thÃ¬ mÃ¬nh cÅ©ng khÃ¡ lÃ  gÃ  trong viá»‡c viáº¿t script nÃ y ğŸ˜¥ğŸ˜¥ğŸ˜¥    
Sau khi Ä‘á»c láº¡i code vÃ  cá»‘ viáº¿t láº¡i graph cÃ¡ch hoáº¡t Ä‘á»™ng cá»§a chÆ°Æ¡ng trÃ¬nh thÃ¬ mÃ¬nh cÅ©ng hiá»ƒu sÆ¡ sÆ¡ nhÆ°ng nÃ³ khÃ¡ lÃ  phá»©c táº¡p nÃªn mÃ¬nh chá»‰ Ä‘á»c Ä‘oáº¡n Ä‘áº§u. KhÃ´ng ngá» cÃ³ team ngá»“i reverse háº¿t Ä‘Æ°á»£c :))) ChÆ°Æ¡ng trÃ¬nh há» viáº¿t láº¡i Ä‘Æ°á»£c thÃ¬ trÃ´ng nÃ³ nhÆ° nÃ y :)))     

![](/ctf/2020/hacktm/baby_bear/hinh4.PNG)    


