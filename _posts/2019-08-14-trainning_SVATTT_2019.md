---
layout : post 
title : Trainning 
subtitle : SVATTT 2019 
--- 

# Má»Ÿ Ä‘áº§u 
KÃ¬ thi sáº¯p tá»›i vÃ  trong Ä‘áº§u mÃ¬nh kiá»ƒu wtf ğŸ˜ğŸ˜ğŸ˜ KhÃ´ng biáº¿t má»i chuyá»‡n sáº½ Ä‘i tá»›i Ä‘Ã¢u :v Tá»« Ä‘á»£t matesctf 2018 cho tá»›i isitdtu team mÃ¬nh Ä‘á»u chá»‰ 
cÃ²n 1 chÃºt ná»¯a lÃ  cÃ³ thá»ƒ lá»t vÃ´ final ğŸ˜­ğŸ˜­ğŸ˜­ That's a sad story. VÃ¬ váº­y Ä‘á»ƒ trÃ¡nh láº·p láº¡i nhá»¯ng tháº¥t báº¡i Ä‘áº§y tiáº¿c nuá»‘i Ä‘Ã³ mÃ¬nh sáº½ láº­p lá»‹ch 
trainning ngay tá»« bÃ¢y giá». Má»¥c tiÃªu lÃ  má»—i ngÃ y chÆ¡i Ã­t nháº¥t 2 bÃ i CTF má»i thá»ƒ loáº¡i :v MÃ¬nh sáº½ note láº¡i nhanh cÃ¡c bÃ i mÃ¬nh lÃ m + nhá»¯ng cÃ¡i new 
mÃ  mÃ¬nh nháº­n Ä‘Æ°á»£c trong cÃ¡c bÃ i ğŸ˜ğŸ˜ğŸ˜ 

# NgÃ y 1  
Do nay ngÃ y Ä‘áº§u tiÃªn nÃªn lÃ  chá»‰ cÃ³ 1 bi thÃ´i :v  
[SvATTT 2018 PyLock](https://drive.google.com/open?id=1CDyi4Ayisgt3hYqwiT4FZlYMEJHErSRx) Ä‘Ã¢y Ä‘Æ°á»£c cho lÃ  1 file exe. TÃªn bÃ i cho ta gá»£i Ã½ lÃ  Ä‘Ã¢y lÃ  1 file python Ä‘Æ°á»£c convert thÃ nh file exe. Viá»‡c Ä‘áº§u tiÃªn cáº§n lÃ m lÃ  Ä‘Æ°a Ä‘Æ°á»£c ngÆ°á»£c trá»Ÿ láº¡i thÃ nh file python .  
DÃ¹ng tool [python-exe-unpacker](https://github.com/countercept/python-exe-unpacker) Ä‘á»ƒ convert. LÃ m theo cÃ¡c bÆ°á»›c sau : 
```
python python-exe-unpacker.py -i unlock.exe
python python-exe-unpacker.py -p unlock 
```
Äá»c kÄ© doc cá»§a tool Ä‘á»ƒ hiá»ƒu táº¡i sao láº¡i cÃ³ nhÆ° váº­y :v 
Sau Ä‘Ã³ Ä‘Æ°á»£c file unlock.py cÃ³ import 1 thÆ° viá»‡c PyLock. Trong cÃ¡i Ä‘á»‘ng Ä‘Æ°á»£c extract trÃªn thÃ¬ ta vÃ o thÆ° má»¥c library cá»§a nÃ³ thÃ¬ tÃ¬m Ä‘Æ°á»£c file PyLock.pyc. DÃ¹ng tool Ä‘á»ƒ convert ngÆ°á»£c trá»Ÿ láº¡i file py thÃ¬ ta decode Ä‘Æ°á»£c hÃ m main . Tá»« Ä‘Ã³ dá»‹ch ngÆ°á»£c láº¡i lÃ  ta cÃ³ Ä‘Æ°á»£c flag.   
Káº¿t thÃºc ngÃ y má»™t, má»i thá»© cá»© gá»i lÃ  ok :v  
![ngay1](/img/meo2.jpg)

# NgÃ y 2  
 - [PlaidCTF 2016 : quick](https://github.com/N4NU/Reversing-Challenges-List/blob/master/Medium_Easy/PlaidCTF_2016_quick/quick.7z)   

BÃ i nÃ y khÃ¡ lÃ  ghÃª Ä‘Æ°á»£c viáº¿t báº±ng swift.Sá»­ dá»¥ng skill chÃ­nh lÃ  Ä‘á»c code. NÃ³i chung lÃ  váº«n khÃ¡ mÃ´ng lung vÃ¬ mÃ¬nh tham kháº£o write up cá»§a [yeuchimse](https://ctf.yeuchimse.com/plaid-ctf-2016-quick-re175/) . Äá»c rá»“i Ä‘á»‘i chiáº¿u vá»›i code trong IDA thÃ¬ ngáº«m láº¡i cÃ³ váº» cÅ©ng Ä‘Ãºng. Sau bÃ i nÃ y rÃºt ra Ä‘Æ°á»£c 1 Ä‘iá»u lÃ  Ä‘Ã´i khi chÃºng ta cáº§n Ä‘oÃ¡n Ä‘Æ°á»£c code Ä‘Ã³ nÃ³ viáº¿t gÃ¬ dá»±a vÃ o máº¡ch code rá»“i check láº¡i . Chá»© khÃ´ng Ä‘á»c háº¿t sáº½ tá»‘n ráº¥t nhiá»u thá»i gian.  
Skill khÃ¡c lÃ  Ä‘Ã´i khi phÃ¢n tÃ­ch 1 hÃ m khÃ´ng cáº§n thiáº¿t Ä‘á»c háº¿t hÃ m. CÄƒn cá»© vÃ o giÃ¡ trá»‹ tráº£ vá» vÃ  giÃ¡ trá»‹ mÃ  ta Ä‘ang quan tÃ¢m Ä‘áº¿n thÃ¬ ta Ä‘á»c tá»« Ä‘Ã³ trá»Ÿ Ä‘i. VÃ­ dá»¥ ta cáº§n quan tÃ¢m xem giÃ¡ trá»‹ tráº£ vá» lÃ  bao nhiÃªu thÃ¬ Ä‘i ngÆ°á»£c tá»« giÃ¡ trá»‹ trá»Ÿ vá» lÃªn. Hoáº·c ta xem giÃ¡ trá»‹ táº¡i con trá» Ä‘Æ°á»£c truyá»n vÃ o hÃ m cÃ³ thay Ä‘á»•i khÃ´ng thÃ¬ láº§n theo Ä‘Ã³ mÃ  Ä‘i.  

# NgÃ y 3  
Nay cháº£ lÃ m Ä‘Æ°á»£c bÃ i nÃ o cáº£. Má»™t pháº§n do Ä‘i thi Ä‘Æ°á»ng lá»‘i , má»™t pháº§n vÃ¬ lÆ°á»i, pháº§n vÃ¬ bÃ i khÃ¡ khoai :(  
![ngay3](/img/meo4.jpg)  

# NgÃ y 4  
Nay chÆ¡i flare on pass Ä‘Æ°á»£c hai level Ä‘áº§u . Cáº£m tháº¥y hiá»‡n táº¡i nÃªn chuyá»ƒn hÆ°á»›ng hoáº¡t Ä‘á»™ng cÃ¡ch máº¡ng sang má»™t hÆ°á»›ng má»›i, khÃ´ng quan trá»ng vá» sá»‘ lÆ°á»£ng mÃ  nÃªn quan trá»ng cháº¥t lÆ°á»£ng. CÃ¡i flare on nÃ y diá»…n ra trong tá»›i 6 tuáº§n, nÃªn cÃ³ thá»i gian Ä‘á»ƒ tÃ¬m hiá»ƒu ngÃ¢m cá»©u. Tiáº¿p theo mÃ¬nh sáº½ ngÃ¢m cá»©u vá» [android pentesting](https://github.com/tsug0d/AndroidMobilePentest101/tree/master/vietnamese) Ä‘á»ƒ pass level 3. ğŸ˜‰  
# NgÃ y 5  
Sau má»™t há»“i ngá»¥p láº·n trong jadx mÃ  váº«n cháº³ng hiá»ƒu cÃ¡i gÃ¬ ğŸ˜¢ğŸ˜¢ğŸ˜¢ Quay láº¡i cÃ y cÆ¡ báº£n.   
  - [android pentesting](https://github.com/tsug0d/AndroidMobilePentest101/tree/master/vietnamese)  
    + chap 1 : set up enviroment. MÃ¬nh thá»­ tá»± xá»­ báº±ng android studio nhÆ°ng mÃ©o biáº¿t dÃ¹ng. CÃ i thá»­ theo ngÆ°á»i ta v. Hmmm  ğŸ˜“ğŸ˜“ğŸ˜“ á»Ÿ quÃª máº¡ng cháº­m set up lÃ¢u vl.  

Somehow nghá»‹ch má»™t há»“i láº¡i ra Ä‘Æ°á»£c flag nÃªn stop cÃ¡i turtorial nghiÃªn cá»©u android pentest táº¡i Ä‘Ã¢y ğŸ˜ƒğŸ˜ƒğŸ˜ƒ Do tem cÅ©ng cÃ³ tháº±ng nháº­n lÃ m android rá»“i nÃªn mÃ¬nh cÅ©ng ko ngÃ¢m cá»©u sÃ¢u.  

# NgÃ y 6  
Trá»Ÿ láº¡i vá»›i pwn má»™t chÃºt.  
 - [MMA CTF 2nd 2016 : greeting-150](https://github.com/ctfs/write-ups-2016/tree/master/mma-ctf-2nd-2016/pwn/greeting-150)  
 BÃ i nÃ y dÃ¹ng ghi Ä‘Ã¨ lÃªn fini . KhÃ´ng cÃ³ realloc nÃªn cÅ©ng dá»… dÃ ng thá»±c hiá»‡n hÆ¡n.  
 - [[DEFCON CTF 2016] xkcd - Baby's First](https://github.com/smokeleeteveryday/CTF_WRITEUPS/tree/master/2016/DEFCONCTF/babysfirst/xkcd)  
 BÃ i nÃ y khÃ´ng táº¥n cÃ´ng chiáº¿m quyá»n mÃ  chá»‰ táº­n dá»¥ng lá»—i trÃ n vÃ o giÃ¡ trá»‹ null cá»§a char Ä‘á»ƒ in ra flag thÃ´i.  

# NgÃ y 7  
 - [SSCTF_2016_Quals_Re2](https://github.com/N4NU/Reversing-Challenges-List/tree/master/Medium_Easy/SSCTF_2016_Quals_Re2)  
 Nay ngá»“i nghá»‹ch láº¡i bÃ i nÃ y thÃ¬ Ä‘Ã£ fix Ä‘Æ°á»£c Ä‘oáº¡n anti disassembly, note láº¡i má»™t sá»‘ trick Ä‘Ã£ dÃ¹ng trong bÃ i : 
   + jmp const : xor eax, eax; jmp .... ,jz + jnz to same addr , not fix into jmp   
   + jmp bá» qua má»™t Ä‘oáº¡n code -> nop all code not execute 
   + nop táº¥t cáº£ Ä‘oáº¡n code ko Ä‘Æ°á»£c thá»±c thi.  
 Script nop : 
 ```python 
def n(start,length) : 
	for i in range(0, length) : 
		PatchByte(start+i, 0x90) 
	MakeCode(start) 
 ```  
 - [DEF CON CTF Quals 2017 - mute](https://fadec0d3.blogspot.com/2017/05/def-con-ctf-quals-2017-mute.html)  
 BÃ i nÃ y vá» side channel attack. Tháº¥y side channel attack lÃ  gÃ¬ trÃ´ng láº¡ láº¡ nÃªn mÃ¬nh Ä‘á»c qua tÃ­ :v Xem Ã½ tÆ°á»Ÿng tháº¿ nÃ o chá»© chÆ°a viáº¿t cá»¥ thá»ƒ. Ã tÆ°á»Ÿng cá»§a bÃ i nÃ y lÃ  ngÆ°á»i ta cho mÃ¬nh má»™t Ä‘oáº¡n shellcode chá»‰ Ä‘Æ°á»£c gá»i má»™t sá»‘ syscall nhÆ° Ä‘á»c , má»Ÿ nhÆ°ng ko cÃ³ ghi. Idea lÃ  sáº½ thá»±c hiá»‡n má»Ÿ file flag, Ä‘á»c file rá»“i so sÃ¡nh tá»«ng kÃ­ tá»± trong file flag. Náº¿u mÃ  trÃ¹ng thÃ¬ end cÃ²n khÃ´ng trÃ¹ng thÃ¬ sáº½ táº¡o má»™t vÃ²ng láº·p vÃ´ háº¡n, tá»©c lÃ  thá»i gian sáº½ dÃ i hÆ¡n nhiá»u. Idea hay vc ğŸ‘ğŸ‘ğŸ‘ CÅ©ng khÃ¡ lÃ  dá»… hiá»ƒu nhÆ°ng Ä‘á»ƒ váº­n dá»¥ng Ä‘Æ°á»£c láº¡i ráº¥t lÃ  khÃ³.  

# NgÃ y 8  
 - [SSCTF_2016_Quals_Re3](https://github.com/N4NU/Reversing-Challenges-List/blob/master/Medium_Easy/SSCTF_2016_Quals_Re3/Re3.7z)  
 Cáº£ sÃ¡ng ngá»“i reverse cÃ¡i nÃ y. Váº«n cÃ²n vÆ°á»›ng má»™t sá»‘ chá»— nÃ³ chÆ°a cÃ³ rÃµ rÃ ng láº¯m nhÆ°ng cÆ¡ báº£n lÃ  hiá»ƒu Ä‘Æ°á»£c cÃ¡ch nÃ³ check flag. CÃ³ má»™t cÃ¡i technique hay dÃ¹ng khi reverse nhÆ°ng binary lá»›n nhÆ° nÃ y lÃ  Ctrl+x rá»“i flow theo nhá»¯ng hÃ m quan trá»ng. á» Ä‘Ã¢y mÃ¬nh flow theo hÃ m MessageBoxA. LÃºc Ä‘áº§u mÃ¬nh flow theo string ```PlsTryAgain``` thÃ¬ ra Ä‘Æ°á»£c má»™t Ä‘oáº¡n code obfucate -> deobfucate cÆ¡ mÃ  nÃ³ cÅ©ng cháº£ liÃªn quan tá»›i chÆ°Æ¡ng trÃ¬nh cá»§a mÃ¬nh :v  
 - [Defcon 2015 Quals babyecho](https://github.com/ctfs/write-ups-2015/tree/master/defcon-qualifier-ctf-2015/babys-first/babyecho)  
 BÃ i nÃ y nÃ³ Ä‘áº·c biá»‡t á»Ÿ chá»— khÃ´ng cÃ³ má»™t hÃ m import nÃ o mÃ  nÃ³ kiá»ƒu lÃ  static linking. MÃ¬nh pháº£i xÃ¡c Ä‘á»‹nh chá»©c nÄƒng cá»§a cÃ¡c hÃ m. NhÆ°ng cÅ©ng cÃ³ thá»ƒ dá»±a vÃ o guessing technique ğŸ˜„ğŸ˜„ğŸ˜„ Ä‘á»ƒ cÃ³ thá»ƒ tra ra má»™t sá»‘ hÃ m cÆ¡ báº£n. Sau Ä‘Ã³ chÃºng ta pháº£i leak Ä‘á»‹a chá»‰ stack rá»“i ghi Ä‘Ã¨ lÃªn Ä‘á»‹a chá»‰ trá»Ÿ vá» cá»§a main báº±ng Ä‘á»‹a chá»‰ cá»§a shellcode báº±ng lá»—i format string. ğŸ˜¤ğŸ˜¤ğŸ˜¤ Má»i thá»© mÆ°á»£t mÃ  Ä‘áº¿n phÃºt cuá»‘i r mÃ  mÃ¬nh tá»± tÃ¬m shellcode thÃ¬ Ä‘Ã©o cháº¡y cho. Láº¥y shellcode trong wu cá»§a ngÆ°á»i ta á»‘p vÃ o láº¡i Ä‘Æ°á»£c. Magic vÃ£i.  

# NgÃ y 9  
 - Nay chá»‰ chÆ¡i vá»›i babystack bÃªn pwnable.tw nhÆ°ng váº«n chÆ°a ra. Cáº£m giÃ¡c Ä‘áº§u tÆ° thá»i gian chÆ°a Ä‘á»§.  

# NgÃ y 10  
  - Nay chÆ¡i giáº£i hackonCTF2019 lÃ m Ä‘Æ°á»£c 3 bÃ i reverse. Cáº£m giÃ¡c cÃ´ng sá»©c bá» ra Ä‘Ã£ cÃ³ tÃ­ thÃ nh tá»±u. CÃ³ cÃ¡c kÄ© thuáº­t chá»§ yáº¿u thiÃªn vá» phÃ¢n tÃ­ch tÄ©nh Ä‘á»c code lÃ  chÃ­nh, cÃ³ bÃ i thá»±c hiá»‡n kÄ© thuáº­t anti disassemble tÃ­ thÃ´i :v   

# NgÃ y 11  
  - [SVATT 2016 C0ffee](https://bo8blog.wordpress.com/2016/11/07/vong-loai-svattt-2016-pwn200-c0ffee-write-up/?fbclid=IwAR1OHLAOMEFnmq8DR4NoqkT_-KanWAmLztW2XPQRe1FNm1ARD_wb2HZlftA)  
  ğŸ˜ğŸ˜ğŸ˜ Nay ná»•i há»©ng lÃªn lÃ m pwn cá»§a SVATTT vÃ¬ máº¥y bÃ i bÃªn pwnable.tw khoai vl. Vá»«a lÃ m vá»«a chÆ¡i mÃ  bÃ i nÃ y xong trong vÃ²ng 3 tiáº¿ng :v CÅ©ng Ä‘Æ°á»£c áº¥y chá»© . CÅ©ng gá»i lÃ  cÃ³ tÃ­ hope vÃ o pwn trong tÆ°Æ¡ng lai rá»“i. BÃ i nÃ y lÃ  táº­n dá»¥ng lá»—i off-byte-one Ä‘á»ƒ ghi Ä‘Ã¨ lÃªn biáº¿n Ä‘áº¿m sá»‘ láº§n Ä‘á»ƒ cÃ³ thá»ƒ ghi vÃ´ háº¡n :v Sau Ä‘Ã³ thÃ¬ lÃ  basis rop thÃ´i . CÆ¡ mÃ  cÃ¡i rop mÃ¬nh váº«n cÃ²n yáº¿u vl nÃªn lÃ m Ä‘oáº¡n Ä‘Ã³ khÃ¡ cháº­m. Vá»›i cáº£ váº¥n Ä‘á» code cÅ©ng hay sai. Luyá»‡n nhiá»u lÃªn lÃ  cáº£i thiá»‡n Ä‘Æ°á»£c tá»‘c Ä‘á»™ :v  

  ![meo5](/img/meo5.jpg)  

# NgÃ y 12  
**CodeFest** 
  - Linux Re 1 : má»™t file linux bá»‹ pack. DÃ¹ng Upx unpack Ä‘Æ°á»£c file C++ -> solve  
  - Linux Re 2 : Má»™t loáº¡t phÆ°Æ¡ng trÃ¬nh , dÃ¹ng [Z3](https://stackoverflow.com/questions/55083687/solve-multiple-equations-using-z3) Ä‘á»ƒ giáº£i. Cháº¯c cÃ³ cÃ¡ch ngáº¯n hÆ¡n lÃ  dÃ¹ng angr nhÆ°ng trÃ¬nh cÃ¹i Ä‘Ã©o bt dÃ¹ng :v  

**ConfuserEx**  
  - Má»™t loáº¡i pack cá»§a file .NET . DÃ¹ng [Nofuser2](https://github.com/CodeShark-Dev/NoFuserEx) rá»“i dÃ¹ng [de4dot](https://github.com/0xd4d/de4dot)  

**SVATTT 2018 Quals**  
 - [Encoder](https://github.com/chung96vn/writeup/tree/master/SVATTT-2018-Quals/Encoder)  
 BÃ i nÃ y cÃ³ má»™t lá»—i format string khÃ¡ rÃµ rÃ ng. NhÆ°ng nÃ³ Ä‘Æ°á»£c báº­t full cÆ¡ cháº¿ báº£o vá»‡ nÃªn cÅ©ng khÃ¡ lÃ  khÃ³ Äƒn theo hÆ°á»›ng thÃ´ng thÆ°á»ng mÃ¬nh váº«n lÃ m. Má»¥c Ä‘Ã­ch cá»§a bÃ i nÃ y khÃ´ng pháº£i táº¥n cÃ´ng chiáº¿m quyá»n mÃ  tÃ¬m cÃ¡ch in ra flag. LÃºc Ä‘áº§u mÃ¬nh Ä‘á»c nháº§m nÃªn cÃ³ nhá»¯ng Ä‘á»‹nh hÆ°á»›ng hÆ¡i sai. Má»™t kinh nghiá»‡m rÃºt ra lÃ  Ä‘Ã´i khi bÃ i khÃ´ng khÃ³ nhÆ° tÆ°á»Ÿng tÆ°á»£ng, Ä‘á»c láº¡i xem mÃ¬nh cÃ³ sai á»Ÿ Ä‘Ã¢u khÃ´ng cÅ©ng lÃ  1 cÃ¡ch khi Ä‘ang háº¿t nÆ°á»›c. MÃ¬nh cÅ©ng rÃºt ra Ä‘Æ°á»£c 1 vÃ i Ä‘iá»u khÃ¡ hay vá» format string :  
 	+ nÃ³ cÃ³ thá»ƒ dÃ¹ng Ä‘á»ƒ Ä‘á»c dá»¯ liá»‡u. TrÆ°á»›c Ä‘Ã¢y mÃ¬nh toÃ n dÃ¹ng Ä‘á»ƒ ghi nÃªn khÃ´ng chÃº Ã½ Ä‘áº¿n chá»©c nÄƒng nÃ y láº¯m. ğŸ˜“ğŸ˜“ğŸ˜“  
	+ Khi Ä‘á»c háº¿t kÃ­ tá»± trÃªn con trá» truyá»n vÃ o hÃ m printf thÃ¬ nÃ³ Ä‘á»c tiáº¿p tá»›i ```stdin```  



# Káº¿t thÃºc  
Tu tiÃªn Ä‘áº¡i Ä‘áº¡o gian nan, mong má»™t ngÃ y cÃ³ thá»ƒ quÃ¡t thÃ¡o tiÃªn giá»›i :v  

![hinh1](/Trainning/pham-nhan-tu-tien-vng-phap-bao-02.jpg)
